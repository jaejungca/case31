---
title: "Project with Case 31"
subtitle: "Data Preparation"
author: "Jae Jung"
institute: "IBM 3302, Cal Poly Pomona"
date: "`r Sys.Date()`"
format: 
  revealjs:
    footer: Case 31 Project
    transition: slide
    transition-speed: default
    toc: true
    toc-depth: 1
    slide-number: true
    scrollable: true
    smaller: true
    code-fold: false
    code-overflow: wrap
    code-copy: true
    number-sections: true
    embed-resources: true
    self-contained-math: true
editor: visual
execute: 
  echo: true
  freeze: auto
---

# Libraries {background-color="aquamarine"}

## Loading common packages

```{r}
# install.packages("haven")
library(tidyverse)
library(haven) 
library(labelled) 
library(janitor) 
library(sjPlot)
library(psych)
set_theme(theme_minimal())
```

# Setting Up Data {background-color="aquamarine"}

## Reading SPSS data {.smaller}

```{r}
#| output-location: fragment

data <- read_spss("Case 31 Data_efcu_1.sav")
data <- data |> 
  clean_names()

# generate data dictionary
data |>
  view_df()

```

# Data Preparation {background-color="aquamarine"}

## Attitudes towards Employee Proficiency {.smaller}

### q3

```{r}
data |> # ctr + shift + M
  count(q3) |> 
  mutate(percent = n/sum(n))
```

---

```{r}
data_clean <- data |> 
  set_value_labels(q3 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5)) |> 
  set_variable_labels(q3 = "Employees are Courteous")

data_clean |> 
  select(q3) |> 
  var_label() 

data_clean |> 
  select(q3) |> 
  val_labels()
```

---

### q4 {.smaller}

```{r}
data_clean <-  data_clean |> 
  set_variable_labels(q4 = "Employees are helpful") |> 
  set_value_labels(q4 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5)) 

data_clean |> 
  select(q4) |>
  var_label()

data_clean |> 
  select(q4) |> 
  val_labels()
```

---

### q5 and q6

```{r}
data_clean <- data_clean |> 
  set_variable_labels(q5 = "Employees are professional") |> 
  set_value_labels(q5 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5)) |> 
  set_variable_labels(q6 = "Employees are available") |> 
  set_value_labels(q6 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5))
data_clean |> 
  select(q5, q6) |>
  var_label()

data_clean |> 
  select(q5, q6) |> 
  val_labels()
```

---

### Reliability analysis

```{r}
#| output-location: fragment
library(psych)
data_clean |> 
  select(q3:q6) |> alpha() #.87
```

---

### factor analysis

```{r}
fa_at_emp <- data_clean |> 
  select(q3:q6) |> 
  fa(nfactors = 1, rotate = "none") 

print(fa_at_emp)

fa.diagram(fa_at_emp)

data_clean |> 
  select(q3:q6) |> 
  scree()

```

---

### PCA

```{r}
pca_result <- data_clean |>
  select(q3:q6) |> 
  prcomp(scale. = TRUE) 

summary(pca_result)$importance[2,1] * 100
```

---

### Creating a composite scale

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(at_emp = rowMeans(across(q3:q6), na.rm = TRUE)) 

describe(data_clean$at_emp)

```

## q7r {.smaller}

::::: columns
::: {.column width="40%"}
```{r}
data_clean |> count(q7)
```
:::

::: {.column width="60%"}
```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q7r = case_when(q7 == 1 ~ 5,
                         q7 == 2 ~ 4,
                         q7 == 3 ~ 3,
                         q7 == 4 ~ 2,
                         q7 == 5 ~ 1,
                         TRUE    ~ NA)) |> 
  set_variable_labels(q7r = "Savings rates") |> 
  set_value_labels(q7r = c("Very Low" = 1,
                           "Low" = 2,
                           "Average" = 3,
                           "High" = 4,
                           "Very High" = 5))

data_clean |> count(q7r)
```
:::
:::::

## q8r

```{r}
#| output-location: fragment

data_clean |> count(q8)
```

---

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q8r = case_when(q8 == 1 ~ 5,
                         q8 == 2 ~ 4,
                         q8 == 3 ~ 3,
                         q8 == 4 ~ 2,
                         q8 == 5 ~ 1,
                         TRUE    ~ NA)) |> 
  set_variable_labels(q8r = "Fund borrowing rates") |> 
  set_value_labels(q8r = c("Very Low" = 1,
                           "Low" = 2,
                           "Average" = 3,
                           "High" = 4,
                           "Very High" = 5))

data_clean |> count(q8r)
```

---

## q9r

```{r}
#| output-location: fragment

data_clean |> count(q9)
```

---

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q9r = 6 - q9) |> 
  set_variable_labels(q9r = "Statement Frequency") |> 
  set_value_labels(q9r = c("Never" = 1,
                           "Not Often Enough" = 2,
                           "About Right" = 3,
                           "Very Often" = 4,
                           "Too Often" = 5))
data_clean |> count(q9r)  
```

------------------------------------------------------------------------

## q10r

```{r}
#| output-location: fragment

data_clean |> count(q10)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q10r = 5 - q10) |> 
  set_variable_labels(q10r = "Statement Accuracy") |> 
  set_value_labels(q10r = c("Poor" = 1,
                           "Fair" = 2,
                           "Good" = 3,
                           "Excellent" = 4))
data_clean |> count(q10r)  
```

## q13r

```{r}
#| output-location: fragment

data_clean |> count(q13)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q13r = 4 - q13) |> 
  set_variable_labels(q13r = "Regular share account") |> 
  set_value_labels(q13r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q13r)  
```

## q14r

```{r}
#| output-location: fragment

data_clean |> count(q14)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q14r = 4 - q14) |> 
  set_variable_labels(q14r = "Special subaccounts") |> 
  set_value_labels(q14r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q14r)  

```

## q15r

```{r}
#| output-location: fragment

data_clean |> count(q15)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q15r = 4 - q15) |> 
  set_variable_labels(q15r = "Christmas club account") |> 
  set_value_labels(q15r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q15r)  
```

## q16r

```{r}
#| output-location: fragment

data_clean |> count(q16)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q16r = 4 - q16) |> 
  set_variable_labels(q16r = "IRA") |> 
  set_value_labels(q16r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q16r)  
```

## q17r

```{r}
#| output-location: fragment

data_clean |> count(q17)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q17r = 4 - q17) |> 
  set_variable_labels(q17r = "Master credit card") |> 
  set_value_labels(q17r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q17r)  
```

## q18r

```{r}
#| output-location: fragment

data_clean |> count(q18)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q18r = 4 - q18) |> 
  set_variable_labels(q18r = "Signature loans") |> 
  set_value_labels(q18r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q18r)  
```

## q19r

```{r}
#| output-location: fragment

data_clean |> count(q19)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q19r = 4 - q19) |> 
  set_variable_labels(q19r = "New car loans") |> 
  set_value_labels(q19r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q19r)  
```

## q20r

```{r}
#| output-location: fragment

data_clean |> count(q20)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q20r = 4 - q20) |> 
  set_variable_labels(q20r = "Late model car loans") |> 
  set_value_labels(q20r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q20r)  
```

## q21r

```{r}
#| output-location: fragment

data_clean |> count(q21)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q21r = 4 - q21) |> 
  set_variable_labels(q21r = "Older model car loans") |> 
  set_value_labels(q21r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q21r)  
```

## q22r

```{r}
data_clean |> count(q22)

data_clean <- data_clean |> 
  mutate(q22r = 4 - q22) |> 
  set_variable_labels(q22r = "Household goods loans") |> 
  set_value_labels(q22r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q22r)  
```

## q23r

```{r}
data_clean |> count(q23)

data_clean <- data_clean |> 
  mutate(q23r = 4 - q23) |> 
  set_variable_labels(q23r = "Recreational loans") |> 
  set_value_labels(q23r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q23r)  
```

## q24r

```{r}
data_clean |> count(q24)

data_clean <- data_clean |> 
  mutate(q24r = 4 - q24) |> 
  set_variable_labels(q24r = "Share collateralized loan") |> 
  set_value_labels(q24r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q24r)  
```

## q25r

```{r}
data_clean |> count(q25)

data_clean <- data_clean |> 
  mutate(q25r = 4 - q25) |> 
  set_variable_labels(q25r = "IRA loans") |> 
  set_value_labels(q25r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q25r)  
```

## q26r

```{r}
data_clean |> count(q26)

data_clean <- data_clean |> 
  mutate(q26r = 4 - q26) |> 
  set_variable_labels(q26r = "Line of credit loans") |> 
  set_value_labels(q26r = c("Unaware" = 1,
                           "Aware but Have Not Used" = 2,
                           "Aware and Have Used" = 3))
data_clean |> count(q26r)  
```

## q30 - q34 {.smaller}

```{r}
data_clean <-  data_clean |> 
  set_value_labels(q30 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5)) |> 
  set_value_labels(q31 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5))|> 
  set_value_labels(q32 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5))|> 
  set_value_labels(q33 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5))|> 
  set_value_labels(q34 = c("Strongly Disagree" = 1,
                          "Disagree" = 2,
                          "Uncertain" = 3,
                          "Agree" = 4,
                          "Strongly Agree" = 5))
```

## q37r

```{r}
#| output-location: fragment

data_clean |> count(q37)
```

------------------------------------------------------------------------

```{r}
#| output-location: fragment

data_clean <- data_clean |> 
  mutate(q37r = case_when(q37 == 1 ~ 5,
                          q37 == 2 ~ 4,
                          q37 == 3 ~ 3,
                          q37 == 4 ~ 2,
                          q37 == 5 ~ 1,
                          q37 == 6 ~ NA)) |> 
  set_value_labels(q37r = c("Very Poor" = 1,
                            "Poor" = 2,
                            "Average" = 3,
                            "Good" = 4,
                            "Excellent" = 5))

data_clean |> count(q37r)
```

```{r}
#| eval: false
#| echo: false

# alternative way using select(): in this case, we need to use anonymous function
data_clean |>
  (\(df) df |> 
    mutate(row_mean = rowMeans(select(df, q3, q4, q5, q6), na.rm = TRUE))
  )() |> 
  select(row_mean)
```

## Renaming Clean Data

```{r}
data_preped <- data_clean

data_preped |> 
  view_df()
```

# Research Questions and Hypotheses {background-color="aquamarine"}

## Research Questions

```         
R1: Why do people join the Credit Union?

R2: Why do members use other financial institutions when they need to borrow funds? 

R3: What are the members’ attitudes and beliefs about the proficiencies of credit union employees?

R4: Are there any perceived differences on attitude towards employee proficiencies, awareness of services, and operational effectiveness between members who live in the area of the firm’s headquarters and members who live elsewhere?

R5: How well are the members aware of the services offered by the credit union?

R6: What are the members’ attitudes and beliefs about how effectively the credit union is operated?
```

## Hypotheses

### H1 - H3

```         
H1: Members’ awareness of the regular share accounts will influence their opinions on the adequacy of financial services in meeting members’ needs.

H2: Members will not be different in their opinion on CU’s loan rate (Q8r) and the degree to which they agree that CU’s loan rate is lower than competitors (Q30).

H3a: There will be interaction effect between the current loan use and location of residence on adequacy of current financial services such that in headquarter area, members who have a loan will agree, more than those who don’t have, that financial services meet the members’ needs, while in outside headquarter area, loan status doesn’t influence adequacy of financial services in meeting member needs.

H3b: Test H2a controlling for the impact of attitudes toward employee proficiency.
```

------------------------------------------------------------------------

### H4 & H5

```         
H4: Compared with the members who have a loan, those members who don’t have a loan currently with the Credit Union will feel that that CU charges them with higher rates, and that they will agree less with the statement that CU’s loan rates are lower than those offered by other institutions.

H5a: Member belief about CU keeps personal financial information confidential will positively influence the overall attitude toward credit union’s operational efficiency.

H5b: Loan application processing promptness will positively influence the overall attitude toward credit union’s operational efficiency.

H5c: Member satisfaction with level of financial services in meeting needs will positively influence the overall attitude toward credit union’s operational efficiency.

H5d: Loan application simplicity and easiness will positively influence the overall attitude toward credit union’s operational efficiency.
```

# R1 {background-color="aquamarine"} {.smaller}

R1: Why do people join the Credit Union?

-   Constructs and roles: reasons why people join the credit union
-   Operationalization:
    -   q7r (Savings rate):
-   Scale
    -   1-5 point, Likert-type scale
-   Statistics:
    -   Descriptive statistics, followed by one-sample t-test

## Descriptive statistics

```{r}
data_preped |> 
  count(q7r) |> 
  mutate(percent = n/sum(n))
```

## one-sample t-test

```{r}
#| output-location: fragment

data_preped |> 
  t.test(q7r ~ 1, mu = 3, data = _)
```

------------------------------------------------------------------------

::: callout-important
## Insights about R1

The majority of the survey participants (65%) think that the savings rate the CU offers is average.The sample mean is 3.07, which is statistically not different from 3 ("average").
:::

# R2 {background-color="aquamarine"}

R2: Why do members use other financial institutions when they need to borrow funds?

# R3 {background-color="aquamarine"}

R3: What are the members’ attitudes and beliefs about the proficiency of credit union employees?

-   Constructs and roles: Attitudes toward employee proficiencies
-   Operationalization:
    -   q3, q4, q5, q6 --\> at_emp
-   Scale: interval scale: 1-5 point, Likert-type scale
-   Statistics:
    -   Descriptive statistics
    -   Reliabilty/factor analysis,
    -   one-sample t-test

## Descriptive Statistics

```{r}
#| output-location: fragment
describe(data_preped$at_emp)
```

------------------------------------------------------------------------

### Histogram

```{r}
#| output-location: slide
data_preped |> 
  ggplot(aes(at_emp)) +
  geom_histogram(binwidth = 0.5, color = "black", fill = "lightblue") +
  geom_vline(aes(xintercept = mean(at_emp, na.rm = TRUE)),
             color = "red", linetype = "dashed", size = 1) +
  geom_text(aes(x = mean(at_emp, na.rm = TRUE), y = 30, 
                label = paste0("Mean = ", round(mean(at_emp), 2))),
            color = "red", angle = 90, vjust = -0.5, hjust = 2.2) +
  labs(title = "Histogram of Employee Proficiencies with Mean Line",
       x = "Employee Prociency",
       y = "Count") +
  scale_x_continuous(expand = c(0,0), limits = c(0, NA))
  
```

## Reliability/factor analysis

-   We already looked at reliability and unidimensionality.
-   The four items are highly representative of the latent construct.
-   Therefore, we created a compositie index and use it

## one-sample t-test

```{r}
#| output-location: fragment
data_preped |> 
  t.test(at_emp ~ 1, mu = 4, data = _)
```

------------------------------------------------------------------------

::: callout-note
## Summary insights about R3

Participants perceived Employee proficiency is 4.21 on average out of 5.0 and is greater than 4.0 ("Agree")
:::

# R4 {background-color="aquamarine"}

R4: Are there any perceived differences on (a) attitude towards employee proficiencies, (b) awareness of services, and (c) operational effectiveness between members who live in the area of the firm’s headquarters and members who live elsewhere?

## R4a Data Analysis Overview

-   R4a: Are there any perceived differences on attitude towards employee proficiencies between members who live in the area of the firm’s headquarters and members who live elsewhere?

```         
- Constructs and roles: 
  - Member residence: IV
  - Attitudes toward employee proficiency: DV 
- Operationalization: 
  - q38
  - at_emp
- Scale: 
  - Nominal scale: 
  - interval scale: 1-5 point, Likert-type scale
- Statistics: 
  - Descriptive statistics, followed by independent samples t-test
```

------------------------------------------------------------------------

### Descriptives

#### Boxplot

```{r}
#| output-location: fragment
data_preped |> 
  mutate(q38 = haven::as_factor(q38)) |> 
  ggplot(aes(q38, at_emp, fill = q38)) +
  geom_boxplot() +
  labs(x = "Live in HQ Area",
       y = "Attitudes toward Employee Proficiency",
       title = "Does Employee Proficiency differ by where customers live?") +
  theme(legend.position = "none")

```

------------------------------------------------------------------------

#### Barplot

```{r}
#| output-location: slide
data_preped |> 
  mutate(q38 = haven::as_factor(q38)) |> 
  group_by(q38) |> 
  summarize(mean = mean(at_emp, na.rm = TRUE)) |> 
  ggplot(aes(q38, mean, fill = q38)) +
  geom_col() +
  labs(x = "Live in HQ Area",
       y = "Attitudes toward Employee Proficiency",
       title = "Does Employee Proficiency differ by where customers live?") +
  theme(legend.position = "none")
```

------------------------------------------------------------------------

### Two independent sample t-test

```{r}
# check for equal variance
library(car)

data_preped |> 
  mutate(q38 = haven::as_factor(q38)) |> 
  leveneTest(at_emp ~ q38, data = _)

data_preped |> 
  mutate(q38 = haven::as_factor(q38)) |> 
  var.test(at_emp ~ q38, data = _)

# t.test: assuming var are equal
data_preped |> 
  t.test(at_emp ~ q38, data = _, var.equal = TRUE) 
```

------------------------------------------------------------------------

::: callout-note
### Summary insights about H4a

The group mean value on employee proficiency for customers who live in HQ and those who live elsewhere are not statistically different.

Thus, we conclude that the location of customer residence is not associated with their perception of CU employee proficiency.
:::

## R4b Data Analysis Overview

-   R4b: Are there any perceived differences on awareness of services between members who live in the area of the firm’s headquarters and members who live elsewhere?

```         
- Constructs and roles: 
  - Member residence: IV
  - service awareness: DV
- Operationalization: 
  - q38
  - q13r - q26r
- Scale: 
  - Nominal scale: 
  - Ordianal scale
- Statistics: 
  - Two-way cross-tab, followed by Chi-square independence test
```

------------------------------------------------------------------------

### Cross-tab and Chi-square

#### q13r by q38

```{r}
data_preped <- data_preped |> 
  mutate(q13r = haven::as_factor(q13r),
         q38 = haven::as_factor(q38))

# cross-tabulation: count
table(data_preped$q13r, data_preped$q38)

# cross-tab: %
table(data_preped$q13r, data_preped$q38) |> 
  prop.table(margin = 2) * 100 

# Chi-square test of independence
table(data_preped$q13r, data_preped$q38) |>
  chisq.test() 

table(data_preped$q38, data_preped$q13r) |> 
  mosaicplot(main = "Awareness of Regular share account by Residence", 
             color = TRUE, las = 1 )
```

#### q14r by q38

```{r}
data_preped <- data_preped |> 
  mutate(q14r = haven::as_factor(q14r))

# cross-tabulation: count
table(data_preped$q14r, data_preped$q38)

# cross-tab: %
table(data_preped$q14r, data_preped$q38) |> 
  prop.table(margin = 2) * 100 

# Chi-square test of independence
table(data_preped$q14r, data_preped$q38) |>
  chisq.test() 

table(data_preped$q38, data_preped$q14r) |> 
  mosaicplot(main = "Awareness of Special Sub accounts by Residence", 
             color = TRUE, las = 1 )
```

#### q15r by q38

```{r}
data_preped <- data_preped |> 
  mutate(q15r = haven::as_factor(q15r))

# cross-tabulation: count
table(data_preped$q15r, data_preped$q38)

# cross-tab: %
table(data_preped$q15r, data_preped$q38) |> 
  prop.table(margin = 2) * 100 

# Chi-square test of independence
table(data_preped$q15r, data_preped$q38) |>
  chisq.test() 

table(data_preped$q38, data_preped$q15r) |> 
  mosaicplot(main = "Awareness of Christmas club account by Residence", 
             color = TRUE, las = 1 )
```

### Further cleaning

```{r}
data_preped <- data_preped |> 
  mutate(q13r = haven::as_factor(q13r),
         q14r = haven::as_factor(q14r),
         q15r = haven::as_factor(q15r),
         q16r = haven::as_factor(q16r),
         q17r = haven::as_factor(q17r),
         q18r = haven::as_factor(q18r),
         q19r = haven::as_factor(q19r),
         q20r = haven::as_factor(q20r),
         q21r = haven::as_factor(q21r),
         q22r = haven::as_factor(q22r),
         q23r = haven::as_factor(q23r),
         q24r = haven::as_factor(q24r),
         q25r = haven::as_factor(q25r),
         q26r = haven::as_factor(q26r)
         )
```

## R4c Data Analysis Overview

-   R4c: Are there any perceived differences on operational effectiveness between members who live in the area of the firm’s headquarters and members who live elsewhere?

```         
- Constructs and roles: 
  - Member residence: IV
  - operatoinal effectiveness: DV
- Operationalization: 
  - q38
  - q9r, q10r, 
  - q11-q12r, 
  - q31-q34, 
  - q37r
- Scale: 
  - Nominal scale
  - interval scales
  - Nominal
  - interval
  - interval
- Statistics: D
  - Descriptive statistics, followed by
    - 2-groups t-test 
    - Ch-square independence test
    - 2-groups t-test
    - 2-groups t-test
```

# R5 {background-color="aquamarine"}

R5: How well are the members aware of the services offered by the credit union?

-   Constructs and roles:
    -   Awareness of services:
-   Operationalization:
    -   q13r-q26r
-   Scale:
    -   Ordinal scale:
-   Statistics:
    -   Chi-square goodness-of-fit test

## q13r

```{r}
#| output-location: fragment

p = c(1/3, 1/3, 1/3)
table(data_preped$q13r) |> 
  chisq.test(p = p)

```

## More efficient coding with map()

```{r}
#| output-location: fragment
# data

awareness_long <- data_preped |> 
  select(q13r:q26r) |> 
  pivot_longer(cols = everything(),
               names_to = "services",
               values_to = "awareness")
awareness_long

```

------------------------------------------------------------------------

```{r}
#| output-location: fragment
# Expected proportions (e.g., equal distribution across levels)
exp_p <- c(`Unaware` = 1/3, 
           `Aware but Have Not Used` = 1/3, 
           `Aware and Have Used` = 1/3) 

# Perform chi-square goodness of fit for each product
awareness_long |> 
  group_by(services) |> 
  count(awareness) |> 
  complete(awareness = names(exp_p), fill = list(n = 0)) |> # tidyr
  group_by(services) |> 
  summarise(
    chisq_test = list(chisq.test(
      x = n,
      p = exp_p[levels(factor(awareness))]
  ))
  ) |> 
  mutate(tidy_results = map(chisq_test, broom::tidy)) |> 
  unnest(tidy_results)
```

# R6 {background-color="aquamarine"}

R6: What are the members’ attitudes and beliefs about how effectively the credit union is operated?

# H1 {background-color="aquamarine"}

H1: Members’ awareness of the regular share accounts will influence their opinions on the adequacy of financial services in meeting members’ needs.

# H2 {background-color="aquamarine"}

H2: Members will not be different in their opinion on CU’s loan rate (Q8r) and the degree to which they agree that CU’s loan rate is lower than competitors (Q30).

# H3a {background-color="aquamarine"}

H3a: There will be interaction effect between the current loan use and location of residence on adequacy of current financial services such that in headquarter area, members who have a loan will agree, more than those who don’t have, that financial services meet the members’ needs, while in outside headquarter area, loan status doesn’t influence adequacy of financial services in meeting member needs.

# H3b {background-color="aquamarine"}

H3b: Test H2a controlling for the impact of attitudes toward employee proficiency.
